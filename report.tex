\documentclass{article}

\usepackage[T1]{fontenc}
%\usepackage[norwegian]{babel}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{color}
\usepackage{listings}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{url}

\newcommand{\dd}[2]{\frac{\mathrm{d}#1}{\mathrm{d}#2}}
\newcommand{\ddd}[2]{\frac{\mathrm{d}#1}{\mathrm{d}#2}}
\newcommand{\dpart}[2]{\frac{\partial#1}{\partial#2}}
\newcommand{\dpartt}[2]{\frac{\partial^2#1}{\partial#2^2}}
\newcommand{\qqq}{\qquad\qquad\qquad}
\newcommand{\f}[2]{\frac{#1}{#2}}
\newcommand{\bs}[1]{$\boldsymbol #1$}
\newcommand{\bsa}[1]{\boldsymbol #1}

\lstset{keywordstyle=\color{Red},%\bfseries,
    basicstyle=\small\ttfamily,
    %identifierstyle=\color{NavyBlue},
    commentstyle=\color{Red}\ttfamily,
    stringstyle=\rmfamily,
    %numbers=none,%left,%
    %numberstyle=\scriptsize,%\tiny
    %stepnumber=5,
    numbersep=8pt,
    %showstringspaces=false,
    breaklines=true,
    %frameround=ftff,
    frame=single
    frame=L
}

\begin{document}

\author{Andreas Våvang Solbrå\\Gunnar Raaen\\Anders Hafreager}
\title{INF5620 - a numerical analysis of the two dimensional wave equation}
\maketitle
\newpage

\section*{Abstract}
The two dimensional wave equation can be used to model many interesting problems such as electromagnetic waves and tsunami waves. We create a numerical solver based on an explicit scheme.
\section*{Theory}
The general wave equation with damping coefficient $b$, propagation velocity $q(x,y)$ and source $f(x,y,t)$ is on the form
\begin{align}
\frac{\partial^2 u}{\partial t^2} + b\frac{\partial u}{\partial t} =
\frac{\partial}{\partial x}\left( q (x,y)
\frac{\partial u}{\partial x}\right) +
\frac{\partial}{\partial y}\left( q (x,y)
\frac{\partial u}{\partial y}\right) + f(x,y,t),
\end{align}
or
\begin{align}
\frac{\partial^2 u}{\partial t^2} + b\frac{\partial u}{\partial t} =
\nabla \cdot \big(q(x,y) \nabla u \big )
\end{align}
The velocity function $q(x,y)$ contains the wave propagation speed in the point $(x,y)$. For water waves, this can be interpreted as the depth at the point $(x,y)$. Water waves have approximately wave speed $c(h) \propto \sqrt h$.
\subsection*{Boundary conditions}
When the wave hits an object, i.e. a wall, we use the boundary condition
\begin{align*}
\nabla u\cdot \textbf n = 0 = \dpart{u}{n}
\end{align*}
where $\dpart{u}{n}$ is the derivative in the direction normal to the boundary. 
\section*{Numerical implementation}
\subsection*{Discretization}
The numerical wave equation can be discretized with
\begin{align*}
\Big[D_{tt} u\Big]_{i,j}^n + b\Big[D_tu\Big]_{i,j}^{n+\f{1}{2}} = \Big[D_x [\bar q^x][D_x u]\Big]^n_{i+\f{1}{2},j} + \Big[D_y [\bar q^y][D_y u]\Big]^n_{i,j+\f{1}{2}}
\end{align*}
%We use the standard approximation for the second derivative and the centered difference method f%or the first derivative in time, and a double centered difference in the position derivatives
%\begin{align*}
%\f{u^{n+1}_{i,j} + u^{n-1}_{i,j} - 2u^{n}_{i,j}}{\Delta t^2} + b\f{u^{n+1}_{i,j}-u^{n-1}_{i,j}}{2\Delta t}\\
%= \f{1}{\Delta x}\Bigg(
%\end{align*}

\section*{Verification}
\subsection*{Constant solution}
\subsection*{Exact 1D solution}
\subsection*{Standing wave}
By assuming a constant wave velocity $q(x,y)=k$, a solution to the equation is the standing wave
\begin{align*}
u(x,y,t) &= \exp(-bt)\cos\Big(\f{m_xx\pi}{L_x}\Big)\cos\Big(\f{m_yy\pi}{L_y}\Big)\cos{\omega t}\\
&= \exp(-bt)\cos (k_x x)\cos (k_y y)\cos{\omega t}
\end{align*}
for arbitrary integers $m_x$, $m_y$ and frequency $\omega$. This solution gives a rather messy source term $f(x,y,t)$, but it's trivial to calculate. We rewrite the solution to $u(x,y,t) = T(t)\cdot R(x,y)=T(t)\cdot X(x) \cdot Y(y)$
\begin{align*}
b\dd{T}{t} &= -e^{-bt}(b^2\cos \omega t + b\omega \sin \omega t)\\
\ddd{T}{t} &= e^{-bt}\Big[(b^2 - \omega^2)\cos\omega t + 2b\omega\sin\omega t\Big] \\
\ddd{X}{x} &= - k_x^2 X(x)
\end{align*}
The left hand side of the wave equation now reads
\begin{align*}
e^{-bt}R(x,y)&\Big[ (b^2 - \omega^2)\cos\omega t + 2b\omega\sin\omega t -b^2\cos \omega t - b\omega \sin \omega t \Big]\\
& = e^{-bt}R(x,y)\Big[-\omega^2\cos\omega t + b\omega\sin\omega t\Big]\\
& = u(x,y,t)\Big[-\omega^2 + b\omega\tan\omega t\Big]
\end{align*}
Which gives
\begin{align*}
u(x,y,t)\Big[-\omega^2 + b\omega\tan\omega t\Big] = -q\big[ k_x^2 + k_y^2 \big]u(x,y,t) + f(x,y,t)
\end{align*}
We can solve this for the source term
\begin{align*}
f(x,y,t) &= u(x,y,t)\Big[ k^2 - \omega^2 + b\omega \tan\omega t\Big]
\end{align*}
where $k^2=q(k_x^2 + k_y^2)$. If we choose this as the source term, we only need to calculate the first time derivative to have a unique solution.
\begin{align*}
\dpart{u(x,y,t)}{t}\Big|_{t=0} &= -e^{-bt}(b\cos\omega t + \omega \sin\omega t)\cos(k_xx)\cos(k_yy)\Big|_{t=0}\\
&= -b\cos(k_xx)\cos(k_yy)
\end{align*}

\section*{Applications}

\subsection*{Double slit}
\section*{Parallelization}
\section*{Visualization}
\subsection*{MayaVi}
\subsection*{OpenGL}



\end{document}